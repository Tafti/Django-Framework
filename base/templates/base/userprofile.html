{% extends 'main.html' %}

{% block content %}

<style>
    /* Page-local styles for user profile */
    .profile-container {
        max-width: 980px;
        margin: 28px auto;
        padding: 20px;
        display: grid;
        grid-template-columns: 280px 1fr;
        gap: 24px;
        align-items: start;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        color: #1f2937;
    }

    .profile-card {
        background: #ffffff;
        border: 1px solid #e6e9ee;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 6px 18px rgba(31,41,55,0.06);
        text-align: center;
    }

    .avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: linear-gradient(135deg,#6ee7b7,#3b82f6);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 36px;
        margin-bottom: 12px;
    }

    .username { font-size: 20px; font-weight: 700; margin-bottom: 6px; }
    .user-meta { color: #6b7280; font-size: 14px; margin-bottom: 12px }

    .profile-actions { display:flex; gap:8px; justify-content:center; }
    .btn { padding:8px 12px; border-radius:8px; border:0; cursor:pointer; font-weight:600 }
    .btn-edit { background:#3b82f6; color:white }
    .btn-message { background:#f3f4f6; color:#111827 }

    .lists { background: #fff; border:1px solid #eef2f7; border-radius:12px; padding:18px; }
    .lists h3 { margin-top:0; font-size:18px; color:#111827 }
    .lists ul { list-style:none; padding:0; margin:0; }
    .lists li { padding:10px 0; border-bottom:1px dashed #eef2f7; display:flex; gap:8px; align-items:center; }
    .lists li:last-child { border-bottom: none }
    .room-link { color:#0b61d0; text-decoration:none; font-weight:600 }
    .muted { color:#6b7280; font-size:13px }

    @media (max-width:820px){
        .profile-container{ grid-template-columns: 1fr; padding:14px }
        .profile-card{ text-align:left }
        .profile-actions{ justify-content:flex-start }
    }
</style>

<section class="profile-container">
    <aside class="profile-card">
        <div class="avatar">{{ user.username|slice:":1"|upper }}</div>
        <div class="username">{{ user.username }}</div>
        <div class="user-meta">{{ user.email }}</div>
        <div class="profile-actions">
            <a href="{% url 'user-profile' user.id %}" class="btn btn-edit">View Profile</a>
            <a href="{% url 'create-room' %}" class="btn btn-message">Create Room</a>
        </div>
    </aside>

    <main>
        <div class="lists">
            {% if user_rooms %}
            <h3>Rooms Hosted by {{ user.username }}</h3>
            <ul>
                {% for room in user_rooms %}
                <li>
                    <div style="flex:1">
                        <a class="room-link" href="{% url 'room' room.id %}">{{ room.name }}</a>
                        <div class="muted">{{ room.topic.name }}</div>
                    </div>
                    <div class="muted">Host</div>
                </li>
                {% endfor %}
            </ul>
            {% endif %}

            {% if messaged_rooms %}
            <h3 style="margin-top:18px">Rooms {{ user.username }} Participates In</h3>
            <ul>
                {% for room in messaged_rooms %}
                <li>
                    <div style="flex:1">
                        <a class="room-link" href="{% url 'room' room.id %}">{{ room.name }}</a>
                        <div class="muted">Topic: {{ room.topic.name }}</div>
                    </div>
                    <div class="muted">Host: {{ room.host.username }}</div>
                </li>
                {% endfor %}
            </ul>
            {% endif %}

            {% if messages %}
            <h3 style="margin-top:18px">Recent Messages by {{ user.username }}</h3>
            <ul>
                {% for message in messages|slice:":10" %}
                <li>
                    <div style="flex:1">
                        In <a class="room-link" href="{% url 'room' message.room.id %}">{{ message.room.name }}</a>
                        <div class="muted">"{{ message.body|truncatechars:70 }}" â€¢ {{ message.created|timesince }} ago</div>
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
    </main>
</section>

{% endblock content %}